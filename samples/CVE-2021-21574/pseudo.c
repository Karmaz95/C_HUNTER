// Pseudocode derived from assembly
idx = 0
write_ptr = buf_on_stack; //rbp-0x158
while(1) {
    if ( idx >= strnlen(hex_ptr, 20000) )
        break;

    *write_ptr++ = CONVERT_HEX(hex_ptr[idx]) << 4 | 
                   CONVERT_HEX(hex_ptr[idx+1]);
    idx += 2;
}
if ( buf_on_stack != calculated_sha256 ) {
	if ( memcmp(buf_on_stack, calculated_sha256, 32) )
		retval = EFI_NOT_FOUND;
	}
}